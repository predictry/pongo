var numOfItems=1;var indexOfItem=1;var excludeOptionIDs=new Array();var indexes=new Array();var propertyMetas=new Array();indexes.push(1);function getGraphData(){loadBar.showPleaseWait();$.ajax({url:site_url+"/panel/ajaxGraphComparison",type:"POST",data:filters,dataType:"json",success:function(c){if(c.status==="success"){highchart_categories_data=c.response.highchart_categories;highchart_combination_graph_of_comparison=c.response.highchart_options_series;if(typeof highchart_combination_graph_of_comparison!=="undefined"){y_title=c.response.y_title;getGraphBarComparison("highChartComparisonGraph",highchart_combination_graph_of_comparison)}if(filters.comparison_type==="sales"){getGraphPie("comparisonDonut","Total Regular Sales VS Sales \nfrom Recommended Items",c.response.highchart_pie_data);getGraphPie("comparisonDonut2","Total Regular Page Views VS Page Views \nfrom Recommended Items",c.response.highchart_other_pie_data)}else{getGraphPie("comparisonDonut2","Total Regular Sales VS Sales \nfrom Recommended Items",c.response.highchart_pie_data);getGraphPie("comparisonDonut","Total Regular Page Views VS Page Views \nfrom Recommended Items",c.response.highchart_other_pie_data)}var f=c.response.average_cart_sales_and_qty;if(f.average_regular_qty_items>0){var e=parseFloat((f.average_recommended_qty_items))}else{var e=parseFloat(0)}if(f.average_regular_sub_totals>0){var d=parseFloat((f.average_recommended_sub_totals))}else{var d=parseFloat(0)}var b=Math.floor(e);highchart_ctr_data=c.response.highchart_ctr_data;if(typeof highchart_ctr_data!=="undefined"){getGraphPieWithText("ctrDonut","Click Through Rate (CTR) on Recommendations",highchart_ctr_data)}if(e-b>0){$("div#itemInCartStat").html("<span class='text-float2 percentageOfAverageRecommendationQty'>"+e.toFixed(2)+"%</span>")}else{$("div#itemInCartStat").html("<span class='text-float percentageOfAverageRecommendationQty'>"+e+"%</span>")}b=Math.floor(d);if(d-b>0){$("div#itemSalesInCartStat").html("<span class='text-float2 percentageOfAverageRecommendationSales'>"+d.toFixed(2)+"%</span>")}else{$("div#itemSalesInCartStat").html("<span class='text-float percentageOfAverageRecommendationSales'>"+d+"%</span>")}$(".percentageOfAverageRecommendationQty").html(e.toFixed(2)+"%");$(".percentageOfAverageRecommendationSales").html(d.toFixed(2)+"%");var a='<span id="pieChartInfoText" style="position:absolute; text-align:center;">';a+='<span style="font-size: 42px; color: #000;">'+c.response.ctr_percentage.toFixed(2)+"%</span>";a+="</span>";$("#addText").html(a);$(".percentageOfCTRVal").html(c.response.ctr_percentage.toFixed(2)+"%");$("#qtySummaryInfo").text(f.sum_recommended_qty+" out of "+f.total_combination_of_qty+" items in the carts from recommended items");$("#salesSummaryInfo").text("RM "+f.sum_recommended_sub_totals+" out of RM "+f.total_combination_of_sub_totals+" with recommended items");$("#ctrSummaryInfo").text(c.response.ctr_nr+" recommended items clicked out of "+c.response.ctr_impression+" views")}else{alert("something wrong")}},error:function(){alert("error!")}});return}function getGraphBarComparison(a,b){$("#"+a).highcharts({title:{text:"",x:-20,y:5},chart:{type:"column"},xAxis:{categories:highchart_categories_data},yAxis:{min:0,stackLabels:{enabled:false,style:{fontWeight:"bold",color:(Highcharts.theme&&Highcharts.theme.textColor)||"gray"}},title:{text:y_title}},legend:{align:"right",x:-70,verticalAlign:"top",y:20,floating:true,backgroundColor:(Highcharts.theme&&Highcharts.theme.background2)||"white",borderColor:"#CCC",borderWidth:1,shadow:false},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y}},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:false,color:(Highcharts.theme&&Highcharts.theme.dataLabelsColor)||"white",style:{textShadow:"0 0 3px black, 0 0 3px black"}}}},series:b,credits:{enabled:false}});loadBar.hidePleaseWait()}function getGraphLineComparison(){$("#highChartComparisonGraph").highcharts({title:{text:graph_title,x:-20,y:5},xAxis:{categories:highchart_categories_data},yAxis:{plotLines:[{value:0,width:1,color:"#808080"}]},series:highchart_series_data,credits:{enabled:false}})}function getGraphPie(a,b,c){$(function(){$("#"+a).highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:false},title:{text:b,style:"font-size:18px;"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{size:"60%",allowPointSelect:true,cursor:"pointer",dataLabels:{enabled:true,format:'<b class="text-center">{point.name}</b><br/>{point.percentage:.1f} %',style:{color:(Highcharts.theme&&Highcharts.theme.contrastTextColor)||"black"}}}},series:[{type:"pie",name:"Total",data:c}],credits:{enabled:false},colors:["#0077CC","#FF9900"]})})}function getGraphPieWithText(a,b,c){$("#"+a).highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:false},title:{text:"",style:"font-size:14px;"},tooltip:{pointFormat:"{series.name}: <b>{point.y}</b>"},plotOptions:{pie:{allowPointSelect:true,cursor:"pointer",dataLabels:{enabled:false,format:"<b>{point.name}</b>: {y:.1f}",style:{color:(Highcharts.theme&&Highcharts.theme.contrastTextColor)||"black"}},showInLegend:false}},series:[{type:"pie",name:"Total",data:c}],credits:{enabled:false}},function(g){var e=g.plotLeft+(g.plotWidth*0.5);var d=g.plotTop+(g.plotHeight*0.5);var f='<span id="pieChartInfoText" style="position:absolute; text-align:center;">';f+='<span style="font-size: 42px; color: #000;">'+ctr_of_recommendation+"%</span>";f+="</span>";$("#addText").append(f);f=$("#pieChartInfoText")})}function viewMetaDetail(c,g,b){var k=$("#propertyKey"+c).val();var l=$("#type"+c).val();var j=null;if(propertyMetas[g]!==undefined){var a=$("#"+g+"Wrapper"+c);j=propertyMetas[g][k];selectMetas="<select class='form-control chosen-select' id='value"+c+"' name='value[]'>";var f="";for(var d=0;d<j.length;d++){var h=g+"."+l+"."+k+"."+j[d].toLowerCase().replace(" ","_");f+="<option value='"+h+"'";if(b!==undefined){if(h===b){f+="selected='selected'"}}else{if(d===0){f+="selected='selected'"}}f+=">"+j[d]+"</option>"}selectMetas+=f+"</select>";var e=$("#propertyMetaWrapper"+c);if(e.html()===undefined){selectMetas="<div class='col-sm-6' id='propertyMetaWrapper"+c+"'>"+selectMetas+"</div>";a.append(selectMetas)}else{e.html(selectMetas)}$(".chosen-select").chosen()}}function getFilterType(a,b){var i=$("#type"+a);var g=$("#value"+a);var j=g.parent();var h=(b!==undefined)?b:"";if($("#inputDate"+a).val()!==undefined){j=$("#inputDate"+a).parent()}if($("#propertyKeyWrapper"+a).val()!==undefined){j=$("#propertyKeyWrapper"+a).parent().parent()}switch(i.val()){case"date":var f="<div class='input-group date' id='inputDate"+a+"' data-date-format='YYYY-MM-DD hh:mm A'><input name='value[]' id='value"+a+"' type='text' class='form-control disabled' readonly='' value='"+h+"'/><span class='input-group-addon'><span class='glyphicon glyphicon-calendar'></span></span></div>";j.html(f);g=$("#inputDate"+a);g.datetimepicker();break;case"str":case"list":var e="<input class='form-control' id='value"+a+"' name='value[]' type='text' value='"+h+"'/>";j.html(e);break;case"location":var d=$("#action"+a).val();$.ajax({url:site_url+"/items/key/"+d+"/metas",type:"GET",data:{isDropDown:true,isView:true,id:a,val:h},dataType:"json",success:function(k){if(k.status==="success"){data=k.data;var l="<div class='row ' id='"+d+"Wrapper"+a+"'><div class='col-sm-12' id='propertyKeyWrapper"+a+"'>";l+=k.view+"</div></div>";j.html(l);propertyMetas[d]=k.data;$(".chosen-select").chosen()}},error:function(){alert("error!")}});break;case"num":var c="<input class='form-control' onkeydown='javascript:maskInputToNumeric()' value='"+h+"' id='value"+a+"' name='value[]' type='number'/>";j.html(c);break}}function addItemRule(b,a){var d=false;var g="item_rules_container";var c="#item";if(b!==undefined){d=true;c="#modalItem";type_identifier="#modalType"}else{c="#item";type_identifier="#type"}if(a!==undefined){g=a}var f=$("a.btnAddItemRule");f.removeClass("btnAddItemRule btn-default").addClass("btnRemoveItemRule btn-danger").html("Remove");f.attr("onClick","removeItem("+indexOfItem+", 'item_rule');");indexOfItem+=1;var h={index:indexOfItem,is_ajax:1};var e=site_url+"/rules/item";if(d){e=site_url+"/rules/modalItem"}$.ajax({url:e,type:"GET",data:h,dataType:"json",success:function(i){if(i.status==="success"){$("#"+g).append(i.response);$(".chosen-select").chosen();numOfItems+=1;$(c+indexOfItem).chosen();$(type_identifier+indexOfItem).chosen();$(c+indexOfItem).val("").trigger("chosen:updated");$(c+indexOfItem).on("change",function(j,k){if(!validateSelectedItem(k.selected,"item_id")){$(c+indexOfItem).val("").trigger("chosen:updated")}})}},error:function(){alert("error!")}})}function addItemFunel(){var a=$("a.btnAddItem");a.removeClass("btnAddItem btn-default").addClass("btnRemoveItem btn-danger").html("Remove");a.attr("onClick","removeItem("+indexOfItem+", 'item_funel');");indexOfItem+=1;var b={index:indexOfItem,is_ajax:1};$.ajax({url:site_url+"/panel/itemFunel",type:"GET",data:b,dataType:"json",success:function(c){if(c.status==="success"){$("#item_funel_action_container").append(c.response);numOfItems+=1;$(".chosen-select").chosen();$("#action"+indexOfItem).chosen();$("#item_funel"+indexOfItem).on("change",function(d,e){if(!validateSelectedItem(e.selected,"action_id")){$("#action"+indexOfItem).val("").trigger("chosen:updated")}})}},error:function(){alert("error!")}})}function addItemFilter(){var a=$("a.btnAddItem");a.removeClass("btnAddItem btn-default").addClass("btnRemoveItem btn-danger").html("Remove");a.attr("onClick","removeItem("+indexOfItem+", 'item_funel');");indexOfItem+=1;var b={index:indexOfItem,is_ajax:1};$.ajax({url:site_url+"/filters/item",type:"GET",data:b,dataType:"json",success:function(c){if(c.status==="success"){$("#filter_item_container").append(c.response);numOfItems+=1;$(".chosen-select").chosen()}},error:function(){alert("error!")}})}function addItemWidgetRuleset(){var a=$("a.btnAddItemWidgetRuleset");a.removeClass("btnAddItemWidgetRuleset btn-default").addClass("btnRemoveItemWidgetRuleset btn-danger").html("Remove");a.attr("onClick","removeItem("+indexOfItem+", 'item_rule');");indexOfItem+=1;var b={index:indexOfItem,is_ajax:1};$.ajax({url:site_url+"/widgets/item",type:"GET",data:b,dataType:"json",success:function(c){if(c.status==="success"){$("#item_rules_container").append(c.response);$(".chosen-select").chosen();numOfItems+=1;$("#item"+indexOfItem).chosen();$("#item"+indexOfItem).val("").trigger("chosen:updated");$("#item"+indexOfItem).on("change",function(d,e){if(!validateSelectedItem(e.selected,"item_id")){$("#item"+indexOfItem).val("").trigger("chosen:updated")}})}},error:function(){alert("error!")}})}function editItemRule(b,a){var c={obj:b,index:a,is_ajax:1};$.ajax({url:site_url+"/rules/itemEdit",type:"GET",data:c,dataType:"json",success:function(d){if(d.status==="success"){$("#item_rules_container").append(d.response);$(".chosen-select").chosen();$("#item"+a).chosen();$("#type"+a).chosen();$("#item"+a).val(b.item_id).trigger("chosen:updated");$("#item"+a).on("change",function(e,f){if(!validateSelectedItem(f.selected,"item_id")){$("#item"+a).val("").trigger("chosen:updated")}});indexOfItem=a}},error:function(){alert("error!")}})}function editItemWidgetRuleset(b,a){var c={obj:b,index:a,is_ajax:1};$.ajax({url:site_url+"/widgets/itemEdit",type:"GET",data:c,dataType:"json",success:function(d){if(d.status==="success"){$("#item_rules_container").append(d.response);$(".chosen-select").chosen();$("#item"+a).chosen();$("#type"+a).chosen();$("#item"+a).val(b.ruleset_id).trigger("chosen:updated");$("#item"+a).on("change",function(e,f){if(!validateSelectedItem(f.selected,"item_id")){$("#item"+a).val("").trigger("chosen:updated")}});indexOfItem=a}},error:function(){alert("error!")}})}function editItemWidgetFilter(b,a){var c={obj:b,index:a,is_ajax:1};$.ajax({url:site_url+"/widgets/itemFilterEdit",type:"GET",data:c,dataType:"json",success:function(d){if(d.status==="success"){$("#item_filters_container").append(d.response);$(".chosen-select").chosen();$("#itemfilter"+a).chosen();$("#type"+a).chosen();$("#itemfilter"+a).val(b.filter_id).trigger("chosen:updated");$("#itemfilter"+a).on("change",function(e,f){if(!validateSelectedItem(f.selected,"item_id")){$("#itemfilter"+a).val("").trigger("chosen:updated")}});indexOfItem=a}},error:function(){alert("error!")}})}function editItemFilter(b,a){var c={obj:b,index:a,is_ajax:1};$.ajax({url:site_url+"/filters/itemEdit",type:"GET",data:c,dataType:"json",success:function(e){if(e.status==="success"){$("#filter_item_container").append(e.response);$(".chosen-select").chosen();$("#action"+a).chosen();$("#type"+a).chosen();var d=$("#value"+a);getFilterType(a,d.val());if(a>=indexOfItem){indexOfItem=a}}},error:function(){alert("error!")}})}function setDefaultComparisonType(a){filters.comparison_type=a;getGraphData();return}function gatherSelectedOption(b){var a=[];$("select[name='"+b+"[]'] option:selected").each(function(){a.push(this.value)});return a}function validateSelectedItem(d,b){excludeOptionIDs=gatherSelectedOption(b);if(excludeOptionIDs.length>1){var a=0;for(var c=0;c<excludeOptionIDs.length;c++){if(excludeOptionIDs[c]===d){a+=1}if(a===2){alert("This option already selected");return false}}}return true}function removeItem(c,b){$("#"+b+c).remove();var a=indexes.indexOf(c);if(a>-1){indexes.splice(a,1)}}function maskInputToNumeric(c){var b=c||window.event;var d=b.keyCode;var a=c?c.target:window.event.srcElement;if(!b.shiftKey&&!b.ctrlKey&&!b.altKey){if((d>47&&d<58)||(d>95&&d<106)){if(d>95){d-=(95-47)}a.value=a.value}else{if(d==8){a.value=a.value}else{if(d!=9){b.returnValue=false}}}}}var loadBar;loadBar=loadBar||(function(){var a=$('<div class="modal fade" style="margin-top: 21%; overflow: hidden; z-index: 1060;" id="loadingModal">\n<div class="modal-dialog"><div class="col-sm-offset-4 col-sm-4"><div class="progress progress-striped active"><div class="progress-bar"  role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"><span class="sr-only"></span></div></div></div></div></div>');return{showPleaseWait:function(){a.modal({backdrop:"static",keyboard:false});$(".modal-backdrop").first().css("z-index","1050")},hidePleaseWait:function(){a.modal("hide");$(".modal-backdrop").first().css("z-index","1040")}}})();jQuery(document).ready(function(){$(".alert").alert();$(".dropdown-toggle").dropdown();$(".tt").tooltip();if(typeof graph_data!=="undefined"){new Morris.Bar({element:"defaultActionsChart",data:graph_data,xkey:graph_x_keys,ykeys:graph_y_keys,labels:graph_y_keys,xLabels:"day",hideHover:true})}if(typeof graph_non_default_data!=="undefined"){new Morris.Bar({element:"nonDefaultActionsChart",data:graph_non_default_data,xkey:graph_x_keys,ykeys:graph_y_non_default_keys,labels:graph_y_non_default_keys,xLabels:"day"})}if(typeof highchart_pie_data!=="undefined"){getGraphPie("comparisonDonut","Total Regular Sales VS Sales from Recommended Items",highchart_pie_data);getGraphPie("comparisonDonut2","Total Regular Page Views VS Page Views from Recommended Items",highchart_pageview_pie_data)}if(typeof highchart_ctr_data!=="undefined"){getGraphPieWithText("ctrDonut","Click Through Rate (CTR) on Recommendations",highchart_ctr_data)}if(typeof highchart_average_recommended_items_data!=="undefined"){getGraphPie("averageRecommendedItemsDonut","Average Cart Items with Recommended Items",highchart_average_recommended_items_data)}if(typeof highchart_average_recommended_sales_data!=="undefined"){getGraphPie("averageRecommendedSalesDonut","Average Cart Value with Recommended Items",highchart_average_recommended_sales_data)}if(typeof highchart_series_data!=="undefined"){getGraphBarComparison("highChartComparisonGraph",highchart_combination_graph_of_comparison);$("div#graph_type.btn-group .btn").click(function(){$(this).find("input:radio").attr("checked",true);var c=$(this).find("input[name=options]").val();$(".options_graph_style").each(function(){if($(this).val()!==c){$(this).attr("checked",false)}});if(c==="bar"){getGraphBarComparison()}else{getGraphLineComparison()}return})}$("div#range-type ul.dropdown-menu li a").click(function(f){var c=$(this).parent().parent().parent();var d=c.find(".dropdown-toggle");d.html($(this).text()+' <span class="caret"></span>');c.removeClass("open");f.preventDefault();return false});$("a.btnViewModal").on("click",function(g){var d=$(g.currentTarget).data("target");var h=g.currentTarget.href;var f=$(d);var c=$(d+" .modal-body");var g=1;f.on("show.bs.modal",function(){if(g){c.load(h)}g=0}).modal();return false});$("#viewModal").on("hidden.bs.modal",function(){$(this).removeData("bs.modal")});($("#item1").length>0)?$("#item1").chosen():"";($("#type1").length>0)?$("#type1").chosen():"";($("#action1").length>0)?$("#action1").chosen():"";($("#itemfilter1").length>0)?$("#itemfilter1").chosen():"";($(".multiple-chosen-select").length>0)?$(".multiple-chosen-select").chosen({no_results_text:"Oops, nothing found!"}):"";($("#guideModal").length>0)?$("#guideModal").modal("show"):"";$("#item1").on("change",function(c,d){if(!validateSelectedItem(d.selected)){$("#item1").val("").trigger("chosen:updated")}});$("#expiry_type").bind("change",function(g){var c=this.value;var d=$("#expiry_value_box");if(c==="date/time"){d.find("input#expiry_value").addClass("hide").attr("name","expiry_value_temp");var f=d.find("div#datetimepicker");f.find("input.form-control").attr("name","expiry_value");f.removeClass("hide");$(function(){$("#datetimepicker").datetimepicker();if(expiry_date!==""){$("#datetimepicker").data("DateTimePicker").setDate(expiry_date)}})}else{d.find("div#datetimepicker").addClass("hide").attr("name","expiry_value_temp");var f=d.find("div#datetimepicker");f.find("input.form-control").attr("name","expiry_value_temp");f.addClass("hide");d.find("input#expiry_value").removeClass("hide").attr("name","expiry_value");var h=d.find("input#expiry_value").val();if(!$.isNumeric(h)){d.find("input#expiry_value").val(0)}}});$("#datetimepicker").bind("dp.change",function(){var c=$("#datetimepicker").data("DateTimePicker").getDate();$("#expiry_value_dt").val(c)});$("#expiry_type").change(function(){}).trigger("change");var a=$("ul.setup-panel li a"),b=$(".setup-content");b.hide();a.click(function(f){f.preventDefault();var c=$($(this).attr("href")),d=$(this).closest("li");if(!d.hasClass("disabled")){a.closest("li").removeClass("active");d.addClass("active");b.hide();c.show()}});$("ul.setup-panel li.active a").trigger("click");$("#btnWizardWidgetInfo").on("click",function(d){d.preventDefault();var c=$(".wizardWidgetForm");$.ajax({url:site_url+"/widgets/ajaxSubmitWizardWidget",type:"POST",data:c.serialize(),dataType:"json",success:function(e){if(e.status==="success"){$("ul.setup-panel li:eq(1)").removeClass("disabled");$('ul.setup-panel li a[href="#step-2"]').trigger("click")}else{$(".wizardWidget").html(e.response)}},error:function(){}});return});$("#btnWizardComplete").on("click",function(d){var c=$(".wizardRulesetForm");$.ajax({url:site_url+"/widgets/ajaxSubmitCompleteWizard",type:"POST",data:c.serialize(),dataType:"json",success:function(e){if(e.status==="success"){$("ul.setup-panel li:eq(2)").removeClass("disabled");$("ul.setup-panel li:eq(0)").addClass("disabled");$("ul.setup-panel li:eq(1)").addClass("disabled");$('ul.setup-panel li a[href="#step-3"]').trigger("click");$("#wizardEmbedJS").html(e.response)}},error:function(){}});return});$("#btnSubmitActionNonDefaultSelector").on("click",function(d){d.preventDefault();var c=$(".actionNoDefaultSelectorForm");$.ajax({url:site_url+"/panel/ajaxRenderGraph",type:"POST",data:c.serialize(),dataType:"json",success:function(e){if(e.status==="success"){window.location=site_url+e.response}else{$(".modal-body").html(e.response)}},error:function(){}});return});$("#funel_preference_id").change(function(){$("#funelSelector").submit()});$("div#type_options.btn-group .btn").click(function(){$(this).find("input:radio").attr("checked",true);var c=$(this).find("input[name=options]").val();$(".options_trend").each(function(){if($(this).val()!==c){$(this).attr("checked",false)}});$.ajax({url:site_url+"/panel/trends",type:"POST",data:{type:c},dataType:"json",success:function(d){if(d.status==="success"){$("#trendsContent").html(d.response)}},error:function(){}});return});$("#reportrange").daterangepicker({ranges:{"7 Days Ago":[moment().subtract("days",7),moment()],"31 Days Ago":[moment().subtract("days",31),moment()],"36 Weeks Ago":[moment().subtract("weeks",36),moment()],"12 Months Ago":[moment().subtract("months",12),moment()]},startDate:moment().subtract("days",7),endDate:moment(),maxDate:moment(),applyClass:"btnApplyRange btn btn-primary btn-sm",cancelClass:"btnCancelRange btn btn-default btn-sm pull-right"},function(d,c){$("#reportrange span").html(d.format("MMMM D, YYYY")+" - "+c.format("MMMM D, YYYY"))});$("#reportrange").on("apply.daterangepicker",function(d,c){});$("#reportrange2").daterangepicker({ranges:{"7 Days Ago":[moment().subtract("days",7),moment()],"31 Days Ago":[moment().subtract("days",31),moment()],"36 Weeks Ago":[moment().subtract("weeks",36),moment()],"12 Months Ago":[moment().subtract("months",12),moment()]},startDate:moment().subtract("days",7),endDate:moment(),maxDate:moment(),applyClass:"btnApplyRange btn btn-primary btn-sm",cancelClass:"btnCancelRange btn btn-default btn-sm pull-right"},function(d,c){filters.dt_start=d.format("YYYY-MM-DD");filters.dt_end=c.format("YYYY-MM-DD");$("#reportrange2 span").html(d.format("MMMM D, YYYY")+" - "+c.format("MMMM D, YYYY"))});$("#reportrange2").on("apply.daterangepicker",function(d,c){filters.dt_start=c.startDate.format("YYYY-MM-DD");filters.dt_end=c.endDate.format("YYYY-MM-DD");getGraphData()});$("#date_unit").bind("change",function(d){var c=this.value;filters.date_unit=c;getGraphData()})});